import{CalloutGenerator}from"../../class/CalloutGenerator.min.js";import{ToastGenerator}from"../../class/ToastGenerator.min.js";import{DataTableManager}from"../../class/DataTableManager.min.js";import{DataFormatter}from"../../class/DataFormatter.min.js";import{ModalGenerator}from"../../class/ModalGenerator.min.js";import{ApiService}from"../../class/ApiService.min.js";function phonebookIndexPage(){new ToastGenerator;let o=new CalloutGenerator,n=new DataFormatter,s=new ApiService;new DataTableManager("phoneTable",{columns:[{data:0,name:"id",type:"numeric",createdCell:function(e,t,a,r,o){$(e).addClass("text-light fw-bold")}},{data:1,name:"last_name",type:"string",render:function(e,t,a){return e.toUpperCase()},createdCell:function(e,t,a,r,o){$(e).addClass("text-primary fw-bold")}},{data:2,name:"phone_number",type:"numeric",render:function(e,t,a){return n.format("phone",e)},createdCell:function(e,t,a,r,o){$(e).addClass("text-light fw-bold")}},{data:null,title:"Actions",orderable:!1,render:function(e,t,a){return`<div class="d-flex justify-content-between">${n.format("edit")}${n.format("suppress")}</div>`}}],serverSide:!0,onCreatedRow:function(a,r,e){$(a).find(".edit-btn").on("click",function(){window.location.href="/phonebook/edit?id="+r[0]}),$(a).find(".delete-btn").on("click",function(){let t=new ModalGenerator({id:"suppressModal",title:`Suppression du numéro <strong class="text-primary">${r[1].toUpperCase()+" - "+n.format("phone",r[2])}</strong>`,body:"Êtes-vous sûr de vouloir supprimer ce numéro de téléphoné ? Cette action est irreversible.",options:{headerClass:" bg-dark bg-gradient text-light",closeClass:"btn-close-white"},footerButtons:[{text:'<i class="fas fa-xmark"></i> Annuler',class:"btn-danger",attributes:{"data-bs-dismiss":"modal"}},{text:'<i class="fas fa-trash"></i> Supprimer',class:"btn-primary",onClick:async()=>{try{var e=await s.delete("process.php",{delete:!0,id:r[0]});e.success?($(a).remove(),o.createCallout(e.message,!1)):o.createCallout(e.message)}catch(e){o.createCallout(e.message)}finally{$("#"+t.id).modal("hide")}}}]});t.show()})}})}export{phonebookIndexPage};